---
title: "microbial growth rate"
output: html_document
date: "2024-11-20"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r load libraries}
library(ggplot2)
library(reshape2)
library(dplyr)
#install.packages("FSA")
library(FSA)
#install.packages("ggstatsplot")
library(ggstatsplot)
```
```{r read in data}
microbial_growth_rate <- read.csv("C:/Users/byersa/OneDrive - Lincoln University/Documents/Rutherford/Metagenomics/Growth potential/growth_potential.csv")
microbial_growth_rate$Forest <- as.factor(microbial_growth_rate$Forest)
```
#test for differences between forests
#growth potential
```{r kruskal wallis test}
kruskal.test(d_reciprocal ~ Forest, data = microbial_growth_rate)
```
```{r Dunn test}
dunnTest(d_reciprocal ~ Forest, data = microbial_growth_rate, method = "holm")
```
```{r edit order of factors}
microbial_growth_rate$Forest <- factor(microbial_growth_rate$Forest, levels = c("Silverdale", "Laingholm", "Oratia", "Puketi", "Gadgil","Glenfern", "Windy_Hill","Hirakimata"))
```

```{r}
GR_plot <- ggbetweenstats(
  data = microbial_growth_rate,
  x = Forest,
  y = d_reciprocal,
  type = "nonparametric", 
  p.adjust.method = "holm",
  pairwise.comparisons = TRUE,
  pairwise.display = "significant",
  centrality.plotting = FALSE,
  bf.message = FALSE,
  ggtheme = ggplot2::theme_bw(base_size = 12),
  title = "Maximum growth rates of soil bacterial communities across kauri forests",
  results.subtitle = FALSE,
  violin.args = list(width = 0.6, alpha = 0, na.rm = TRUE),
  boxplot.args = list(width = 0.4, alpha = 0, na.rm = TRUE),
  point.args = list(position = ggplot2::position_jitterdodge(dodge.width = 0.6), alpha =
  4, size = 4, stroke = 0, na.rm = TRUE),
  caption = NULL,
  digits = "scientific1",
  subtitle = NULL,
  palette = "Set1",
  ylab=bquote('Maximum growth rate '(h^-1)))
GR_plot
```
#average genome size
```{r kruskal wallis test}
kruskal.test(AGS_Mbp ~ Forest, data = microbial_growth_rate)
```
```{r Dunn test}
dunnTest(AGS_Mbp ~ Forest, data = microbial_growth_rate, method = "holm")
```
```{r}
AGS_plot <- ggbetweenstats(
  data = microbial_growth_rate,
  x = Forest,
  y = AGS_Mbp,
  type = "nonparametric", 
  p.adjust.method = "holm",
  pairwise.comparisons = TRUE,
  pairwise.display = "significant",
  centrality.plotting = FALSE,
  bf.message = FALSE,
  ggtheme = ggplot2::theme_bw(base_size = 12),
  title = "Average genome size of soil bacterial communities across kauri forests",
  results.subtitle = FALSE,
  violin.args = list(width = 0.6, alpha = 0, na.rm = TRUE),
  boxplot.args = list(width = 0.4, alpha = 0, na.rm = TRUE),
  point.args = list(position = ggplot2::position_jitterdodge(dodge.width = 0.6), alpha =
  4, size = 4, stroke = 0, na.rm = TRUE),
  caption = TRUE,
  digits = "scientific1",
  subtitle = NULL,
  palette = "Set1",
  ylab = "Average genome size (Mbp)")
AGS_plot
```
  
```{r average genome size and growth rate}
AGS_GP_cor <- ggscatterstats(microbial_growth_rate,
  AGS_Mbp,
  d_reciprocal,
  type = "nonparametric",
  conf.level = 0.95,
  tr = 0.2,
  digits = "signif",
  results.subtitle = TRUE,
  marginal = FALSE,
  point.width.jitter = 0,
  point.height.jitter = 0,
  smooth.line.args = list(linewidth = 1.5, color = "blue", method = "lm", formula = y ~ x),
  title = "Spearman correlations between the average genome size and \nthe maximum growth rate of soil bacterial communities in kauri forests",
  subtitle = NULL,
  caption = NULL,
  ggtheme = ggplot2::theme_bw(base_size = 13),
  ggplot.component = NULL, 
  xlab="Average genome size (Mbp)",
  ylab=bquote('Maximum growth rate '(h^-1)))
++++ <- AGS_GP_cor + geom_point(aes(colour=factor(Forest)), size=4)+
  labs(colour="Forest")
```
```{r total carbon and growth rate}
TC_GP_cor <- ggscatterstats(microbial_growth_rate,
  TC,
  d_reciprocal,
  type = "nonparametric",
  conf.level = 0.95,
  tr = 0.2,
  digits = "signif",
  results.subtitle = TRUE,
  marginal = FALSE,
  point.width.jitter = 0,
  point.height.jitter = 0,
  smooth.line.args = list(linewidth = 1.5, color = "blue", method = "lm", formula = y ~ x),
  title = "Spearman correlations between total soil C content and the maximum growth rate \nof soil bacterial communities in kauri forests",
  subtitle = NULL,
  caption = NULL,
  ggtheme = ggplot2::theme_bw(base_size = 13),
  ggplot.component = NULL, 
  xlab="Total soil C (%)",
  ylab=bquote('Maximum growth rate '(h^-1)))
TC_GP_cor2 <- TC_GP_cor + geom_point(aes(colour=factor(Forest)), size=4)+
  labs(colour="Forest")
```
```{r total carbon and growth rate}
CN_GP_cor <- ggscatterstats(microbial_growth_rate,
  CN,
  d_reciprocal,
  type = "nonparametric",
  conf.level = 0.95,
  tr = 0.2,
  digits = "signif",
  results.subtitle = TRUE,
  marginal = FALSE,
  point.width.jitter = 0,
  point.height.jitter = 0,
  smooth.line.args = list(linewidth = 1.5, color = "blue", method = "lm", formula = y ~ x),
  title = "Spearman correlations between the soil C:N ratio and \nthe maximum growth rate of soil bacterial communities in kauri forests",
  subtitle = NULL,
  caption = NULL,
  ggtheme = ggplot2::theme_bw(base_size = 13),
  ggplot.component = NULL, 
  xlab="Soil C:N ratio",
  ylab=bquote('Maximum growth rate '(h^-1)))
CN_GP_cor2 <- CN_GP_cor + geom_point(aes(colour=factor(Forest)), size=4)+
  labs(colour="Forest")
```
```{r total carbon and average genome size}
TC_AGS_cor <- ggscatterstats(microbial_growth_rate,
  TC,
  AGS_Mbp,
  type = "nonparametric",
  conf.level = 0.95,
  tr = 0.2,
  digits = "signif",
  results.subtitle = TRUE,
  marginal = FALSE,
  point.width.jitter = 0,
  point.height.jitter = 0,
  smooth.line.args = list(linewidth = 1.5, color = "blue", method = "lm", formula = y ~ x),
  title = "Spearman correlations between total soil C content and the average genome size \nof soil bacterial communities in kauri forests",
  subtitle = NULL,
  caption = NULL,
  ggtheme = ggplot2::theme_bw(base_size = 13),
  ggplot.component = NULL, 
  xlab="Total soil C (%)",
  ylab="Average genome size (Mbp)")
TC_AGS_cor2 <- TC_AGS_cor + geom_point(aes(colour=factor(Forest)), size=4)+
  labs(colour="Forest")
```
```{r C:N ratio and average genome size}
CN_AGS_cor <- ggscatterstats(microbial_growth_rate,
  CN,
  AGS_Mbp,
  type = "nonparametric",
  conf.level = 0.95,
  tr = 0.2,
  digits = "signif",
  results.subtitle = TRUE,
  marginal = FALSE,
  point.width.jitter = 0,
  point.height.jitter = 0,
  smooth.line.args = list(linewidth = 1.5, color = "blue", method = "lm", formula = y ~ x),
  title = "Spearman correlations between soil C:N ratio and average genome size \nof soil bacterial communities in kauri forests",
  subtitle = NULL,
  caption = NULL,
  ggtheme = ggplot2::theme_bw(base_size = 13),
  ggplot.component = NULL, 
  xlab="Soil C:N ratio",
  ylab="Average genome size (Mbp)")
CN_AGS_cor2 <- CN_AGS_cor + geom_point(aes(colour=factor(Forest)), size=4)+
  labs(colour="Forest")
```
