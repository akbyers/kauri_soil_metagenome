#!/bin/bash -e

#SBATCH --account       lincoln03750
#SBATCH --job-name      annotate_DRAM
#SBATCH --time          4-00:00:00
#SBATCH --mem           150GB
#SBATCH --cpus-per-task 20
#SBATCH --error         %x_%j.err
#SBATCH --output        %x_%j.out
#SBATCH --mail-user    alexa.byers@lincoln.ac.nz
#SBATCH --mail-type    ALL

#annotating biogeochemical cycling genes using DRAM
# Load modules
module purge
module load DRAM/1.3.5-Miniconda3

#change directory
cd /scale_wlg_nobackup/filesets/nobackup/lincoln03750/MGS_RDF/CO_ASSEMBLY
mkdir DRAM

# Run DRAM: input files are dereplicated contigs (concatenated)
DRAM.py annotate -i 'deReplicated_FINAL_BINS/dedupe_contigs/DEDUPE_MAGs_edited.fasta' --prodigal_mode meta -o DRAM/Annotations --threads 20

DRAM.py distill -i DRAM/Annotations/annotations.tsv -o DRAM/genome_summaries --trna_path DRAM/Annotations/trnas.tsv --rrna_path DRAM/Annotations/rrnas.tsv --distillate_gene_names


